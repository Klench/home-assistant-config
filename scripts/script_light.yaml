##### HOME #####

indoor_lights_bright:
  alias: 'Hög ljusstyrka'
  sequence:
    - service: script.turn_on
      target:
        entity_id:
          - script.livingroom_bright
          - script.bedroom_bright
          - script.hallway_bright
          - script.kitchen_bright
          - script.office_bright
    - condition: template
      value_template: >
        {{ not (is_state('binary_sensor.childroom_sonos_is_grouped','off') and is_state('media_player.childroom_sonos','playing')) }}
    - service: script.childroom_bright

bottom_floor_bright:
  sequence:
    - service: script.turn_on
      target:
        entity_id:
          - script.livingroom_bright
          - script.hallway_bright
          - script.kitchen_bright

indoor_lights_relaxed:
  alias: 'Mysbelysning'
  sequence:
    - service: script.turn_on
      target:
        entity_id:
          - script.bedroom_relaxed
          - script.childroom_turn_off
          - script.office_relaxed
          - script.livingroom_relaxed
          - script.hallway_relaxed
          - script.kitchen_relaxed

indoor_lights_low_brightness:
  alias: 'Låg ljusstyrka'
  sequence:
    choose:
      conditions:
        condition: or
        conditions:
          - condition: state
            entity_id: binary_sensor.relaxed_mode
            state: 'on'
          - condition: time
            before: '05:00:00'
      sequence:
        - service: light.turn_off
          target:
            entity_id:
              - light.livingroom_window
              - light.hallway_ceiling_group
        - service: light.turn_on
          data:
            entity_id: light.livingroom_floor
            brightness_pct: 20
            color_temp: 443
            transition: 2
        - service: light.turn_on
          data:
            entity_id: light.kitchen_table
            brightness_pct: 50
            transition: 2
        - service: light.turn_on
          data:
            entity_id: light.office_desk
            brightness_pct: 10
            transition: 2
        - service: script.turn_on
          target:
            entity_id:
              - script.bathroom_low_brightness
    default:
      - service: script.turn_on
        target:
          entity_id:
            - script.livingroom_low_brightness
            - script.hallway_bottom_floor_bright
            - script.kitchen_bright

indoor_lights_off:
  alias: 'Allt släckt'
  sequence:
    - service: light.turn_off
      target:
        entity_id: group.indoor_lights
    - service: script.sonos_set_group_volume
      data:
        volume: 0.1
    - condition: state
      entity_id: binary_sensor.relaxed_mode
      state: 'off'
    - service: light.turn_off
      target:
        entity_id: light.childroom_led_strip

wakeup_lights:
  sequence:
    - service: script.turn_on
      target:
        entity_id:
          - script.livingroom_wakeup
          - script.hallway_wakeup
          - script.kitchen_wakeup
          - script.office_wakeup

window_lights:
  sequence:
    - service: light.turn_on
      target:
        entity_id:
          - light.bedroom_bedside
          - light.livingroom_window
          - light.office_window

go_to_bed_lights:
  sequence:
    - service: light.turn_off
      data:
        entity_id: light.bedroom_ceiling
        transition: 300
    - service: light.turn_off
      data:
        entity_id:
          - light.livingroom_ceiling
          - light.livingroom_floor
        transition: 1800
    - delay: '00:30'
    - service: light.turn_off
      data:
        entity_id: light.hallway_ceiling_group

enable_away_lights:
  sequence:
    - delay: '00:00:10'
    - service: script.turn_on
      target:
        entity_id:
          - script.hallway_relaxed
          - script.kitchen_relaxed
          - script.livingroom_relaxed
    - service: light.turn_on
      data:
        entity_id:
          - light.bedroom_bedside
          - light.office_window

watching_tv_lights:
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.livingroom_floor
        brightness: 144
        color_temp: 443
        transition: 2
    - service: light.turn_off
      target:
        entity_id:
          - light.livingroom_ceiling
          - light.livingroom_window

create_indoor_lights_group:
    sequence:
      - service: group.set
        data:
          object_id: "indoor_lights"
          entities: >
            {%- for device in states.light %}{% if 'outdoor' not in device.entity_id %}{% if 'led_strip' not in device.entity_id %}{%- if loop.first %}{%- else %}, {% endif %}{{ device.entity_id }}{%- if loop.last %}{% endif %}{% endif %}{% endif %}{%- endfor %}

create_all_lights_group:
    sequence:
      - service: group.set
        data:
          object_id: "all_lights"
          entities: >
            {%- for device in states.light %}{%- if loop.first %}{%- else %}, {% endif %}{{ device.entity_id }}{%- if loop.last %}{% endif %}{%- endfor %}

##### BEDROOM #####

bedroom_bright:
  alias: 'Hög ljusstyrka'
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.bedroom_ceiling
        brightness_pct: 80

bedroom_relaxed:
  alias: 'Mysbelysning'
  sequence:
    - service: light.turn_off
      target:
        entity_id: light.bedroom_ceiling
    - service: light.turn_on
      target:
        entity_id: light.bedroom_bedside

bedroom_wakeup:
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.bedroom_ceiling
        brightness_pct: 30
        color_temp: 372
        transition: 1800

##### CHILD ROOM #####

childroom_bright:
  alias: 'Hög ljusstyrka'
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.childroom_ceiling
        brightness_pct: 100
        color_temp: 372
        transition: 2

childroom_relaxed:
  alias: 'Mysbelysning'
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.childroom_ceiling
        brightness_pct: 30
        color_temp: 443
        transition: 2

childroom_night_light:
  alias: 'Nattbelysning'
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.childroom_led_strip
        brightness_pct: 25
        rgb_color: [255,0,0]
        transition: 2
        effect: None

childroom_turn_off:
  sequence:
    - service: light.turn_off
      data:
        entity_id: light.childroom_ceiling

##### OFFICE #####

office_bright:
  alias: 'Hög ljusstyrka'
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.office_ceiling
        brightness_pct: 100

office_relaxed:
  alias: 'Mysbelysning'
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.office_ceiling
        brightness_pct: 20
    - service: light.turn_on
      data:
        entity_id: light.office_desk
        brightness_pct: 40
        transition: 2
    - service: light.turn_on
      data:
        entity_id: light.office_window
        transition: 2

office_wakeup:
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.office_ceiling
        brightness_pct: 30
        transition: 1800

##### LIVINGROOM #####

livingroom_bright:
  alias: 'Hög ljusstyrka'
  sequence:
    - service: light.turn_on
      data:
        entity_id:
          - light.livingroom_dinner_table
          - light.livingroom_couch_table
        brightness_pct: 100
        transition: 2
    - service: light.turn_on
      data:
        entity_id: light.livingroom_floor
        brightness_pct: 100
        color_temp: 372
        transition: 2

livingroom_relaxed:
  alias: 'Mysbelysning'
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.livingroom_dinner_table
        brightness_pct: 10
    - service: light.turn_on
      data:
        entity_id: light.livingroom_couch_table
        brightness_pct: 30
        transition: 2
    - service: light.turn_on
      data:
        entity_id: light.livingroom_floor
        brightness_pct: 40
        color_temp: 443
        transition: 2
    - service: light.turn_on
      target:
        entity_id: light.livingroom_window

livingroom_wakeup:
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.livingroom_floor
        brightness_pct: 100
        color_temp: 372
        transition: 1800

livingroom_low_brightness:
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.livingroom_floor
        brightness_pct: 100
        color_temp: 372
        transition: 2

##### HALLWAY #####

hallway_bright:
  alias: 'Hög ljusstyrka'
  sequence:
    - service: script.ikea_light_turn_on
      data:
        entity_id: light.hallway_ceiling_group
        brightness_pct: 100
        color_temp: 300

hallway_top_floor_bright:
  sequence:
    - service: script.ikea_light_turn_on
      data:
        entity_id: light.hallway_ceiling_top_floor
        brightness_pct: 100
        color_temp: 300

hallway_bottom_floor_bright:
  sequence:
    - service: script.ikea_light_turn_on
      data:
        entity_id: light.hallway_ceiling_bottom_floor
        brightness_pct: 100
        color_temp: 300

hallway_relaxed:
  alias: 'Mysbelysning'
  sequence:
    - service: light.turn_off
      data:
        entity_id: light.hallway_ceiling_top_floor
        transition: 2
    - service: script.ikea_light_turn_on
      data:
        entity_id: light.hallway_ceiling_bottom_floor
        brightness_pct: 1
        color_temp: 443

hallway_wakeup:
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.hallway_ceiling_bottom_floor
        brightness_pct: 1
        transition: 1
    - delay:
        milliseconds: 1100
    - service: light.turn_on
      data:
        entity_id: light.hallway_ceiling_bottom_floor
        color_temp: 300
        transition: 1
    - delay:
        milliseconds: 1100
    - service: light.turn_on
      data:
        entity_id: light.hallway_ceiling_bottom_floor
        brightness_pct: 100
        transition: 1800

##### KITCHEN #####

kitchen_bright:
  alias: 'Hög ljusstyrka'
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.kitchen_table
        brightness_pct: 100
        transition: 2

kitchen_relaxed:
  alias: 'Mysbelysning'
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.kitchen_table
        brightness_pct: 70
        transition: 2

kitchen_wakeup:
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.kitchen_table
        brightness_pct: 100
        transition: 1800

##### BATHROOM #####

bathroom_bright:
  alias: 'Hög ljusstyrka'
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.bathroom_ceiling
        brightness_pct: 100
    - service: light.turn_on
      target:
        entity_id: light.bathroom_mirror

bathroom_low_brightness:
  alias: 'Låg ljusstyrka'
  sequence:
    choose:
      conditions:
        condition: state
        entity_id: light.bathroom_ceiling
        state: 'on'
      sequence:
        - service: light.turn_off
          target:
            entity_id:
              - light.bathroom_mirror
              - light.bathroom_ceiling
        - delay: '00:00:05'
        - service: light.turn_on
          data:
            entity_id: light.bathroom_ceiling
            brightness_pct: 1
    default:
      service: light.turn_on
      data:
        entity_id: light.bathroom_ceiling
        brightness_pct: 1

##### OUTDOOR #####

turn_on_outdoor_lights:
  alias: 'Tänd'
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.outdoor_main_entrance
        brightness_pct: 100
        transition: 2
    - service: light.turn_on
      data:
        entity_id: light.outdoor_rear_entrance
        brightness_pct: 70
        color_temp: 443
        transition: 2

turn_off_outdoor_lights:
  sequence:
    - service: light.turn_off
      target:
        entity_id:
          - light.outdoor_main_entrance
          - light.outdoor_rear_entrance

##### IKEA LIGHTS #####

ikea_light_turn_on:
  sequence:
      - service: light.turn_on
        data:
          entity_id: "{{ entity_id }}"
          brightness_pct: "{{ brightness_pct }}"
          transition: 1
      - delay:
          milliseconds: 1100
      - service: light.turn_on
        data:
          entity_id: "{{ entity_id }}"
          color_temp: "{{ color_temp }}"
          transition: 1